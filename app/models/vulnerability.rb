class Vulnerability < ActiveRecord::Base
  belongs_to :host, :counter_cache => true
  belongs_to :plugin, :counter_cache => true
  
  def name
    plugin.name
  end
  
  def family
    plugin.family
  end
  
  def cve
    plugin.cve
  end
  
  def bugtraq
    plugin.bugtraq
  end

  def risk
    plugin.risk
  end
  
  def summary
    plugin.summary
  end
  
  def service
    if port == 0
      read_attribute(:service)
    else
      "#{read_attribute(:service)} (#{protocol}/#{port})"
    end
  end
  
  def to_s
    data
  end
end
