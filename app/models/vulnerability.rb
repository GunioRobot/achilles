class Vulnerability < ActiveRecord::Base
  belongs_to :host, :counter_cache => true
  belongs_to :plugin, :counter_cache => true
  belongs_to :severity
  belongs_to :status
  
  delegate :name,           :to => :plugin
  delegate :family,         :to => :plugin
  delegate :cve,            :to => :plugin
  delegate :bugtraq,        :to => :plugin
  delegate :risk,           :to => :plugin
  delegate :summary,        :to => :plugin
  delegate :classification, :to => :plugin
  delegate :location,       :to => :host
  
  def service
    if port == 0
      read_attribute(:service)
    else
      "#{read_attribute(:service)} (#{protocol}/#{port})"
    end
  end
  
  def to_s
    data
  end
end
